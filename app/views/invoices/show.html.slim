.invoice-writer
  h3 Contractor #{link_to "(edit)", edit_user_path(current_user), class: "hide-for-print"}
  p= link_to val_or_nil_string(current_user.company_name), edit_user_path(current_user)
  p= val_or_nil_string current_user.street
  p= "#{val_or_nil_string current_user.zip} #{val_or_nil_string current_user.city}"
.row
  .span6.invoice-client
    h3 Client #{link_to "(edit)", edit_client_path(@client), class: "hide-for-print"}
    - if @client.company_name
      p= @client.company_name
    - else
      p= @client.name
    p= val_or_nil_string @client.street
    p= "#{val_or_nil_string @client.zip} #{val_or_nil_string @client.city}"
  .span6.invoice-quick-total
    h3 Invoice summary
    p.key-value
      |Invoice number:
      span #{@invoice.number}
    p.key-value
      |Invoice date:
      span #{l @invoice.created_at}
.inovice-content
  h3 Invoice content
  - if @invoice.content
    = markdown @invoice.content
  - else
    ul
      - (@invoice.worklogs.oldest_first + @invoice.expenses.oldest_first + @invoice.products.oldest_first.uniq).each do |entry|
        li= entry.invoice_title(@invoice.id)
.row
  .span4.offset8.invoice-total
    h3 Invoice total
    p.key-value
      |Subtotal:
      span #{with_currency @invoice.total}
    p.key-value
      span #{@invoice.includes_vat ? "Including" : "Excluding"} VAT:
      span #{with_currency @invoice.total_vat}
    p.key-value
      |Total
      span= with_currency @invoice.calc_vat_total
hr
.row
  .span4
    h3 Payment Info
    p= markdown @invoice.payment_info
  - if @invoice.payment_terms
    .span4
      h3 Payment Terms
      p= markdown @invoice.payment_terms
  - if @invoice.note
    .span4
      h3 Note
      p= markdown @invoice.note
.invoice-controls
  hr
  .btn-group
    = link_to "<i class='icon-edit'></i> Edit invoice".html_safe,
      edit_invoice_path(@invoice), class: "btn btn-primary"
    = link_to "<i class='icon-cloud-download'></i> Download PDF".html_safe,
      pdf_export_invoice_path(@invoice, format: :pdf), class: "btn"
